<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Talabiya Market</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Open Graph / Social preview -->
  <meta property="og:title" content="Talabiya Market" />
  <meta property="og:description" content="Your Local Grocery & Essentials Delivery App." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://mhammoud85.github.io/app-link/" />
  <meta property="og:image" content="https://mhammoud85.github.io/app-link/preview.jpg" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Talabiya Market" />
  <meta name="twitter:description" content="Your Local Grocery & Essentials Delivery App." />
  <meta name="twitter:image" content="https://mhammoud85.github.io/app-link/preview.jpg" />

  <meta http-equiv="refresh" content="120"> <!-- safety auto-refresh -->
  <style>
    :root { color-scheme: light dark; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
           margin: 0; min-height: 100dvh; display: grid; place-items: center; }
    .card { max-width: 680px; padding: 24px; border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,.08); text-align: center; }
    h1 { font-size: 1.25rem; margin: 0 0 8px; }
    p { margin: 6px 0; opacity: .8; }
    .btns { display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; margin-top: 16px; }
    a.button { padding: 12px 16px; border-radius: 12px; text-decoration: none; border: 1px solid #ccc; }
    .hint { font-size: .9rem; opacity: .7; margin-top: 10px; }
    noscript a { display: inline-block; margin: 0 6px; }
  </style>
</head>
<body>
  <div class="card">
    <h1>Select your preferred option:</h1>
    <p id="status">Hang on a moment.</p>

    <div class="btns" id="fallback" hidden>
      <a class="button" id="iosLink" href="https://apps.apple.com/app/id6749238164">Open in Apple App Store</a>
      <a class="button" id="androidLink" href="https://play.google.com/store/apps/details?id=com.mmh.talabiya">Open in Google Play</a>
      <a class="button" id="webLink" href="https://www.talabiyamarket.com">Visit Website</a>
    </div>

    <p class="hint">Tip: add <code>?platform=ios</code> or <code>?platform=android</code> to test from desktop.</p>

    <noscript>
      JavaScript is required for automatic redirection. Use one of these:
      <a href="https://apps.apple.com/app/id6749238164">Apple App Store</a> ·
      <a href="https://play.google.com/store/apps/details?id=com.mmh.talabiya">Google Play</a> ·
      <a href="https://www.talabiyamarket.com">Website</a>
    </noscript>
  </div>

  <script>
    (function () {
      const IOS_URL = "https://apps.apple.com/app/id6749238164";
      const ANDROID_URL = "https://play.google.com/store/apps/details?id=com.mmh.talabiya";
      const WEB_URL = "https://www.talabiyamarket.com";

      document.getElementById("iosLink").href = IOS_URL;
      document.getElementById("androidLink").href = ANDROID_URL;
      document.getElementById("webLink").href = WEB_URL;

      const statusEl = document.getElementById("status");
      const fallbackEl = document.getElementById("fallback");

      const params = new URLSearchParams(location.search);
      const override = (params.get("platform") || "").toLowerCase();

      function isAndroid(ua) { return /android/i.test(ua); }
      function isIOS(ua) {
        return /iPad|iPhone|iPod/.test(ua) || (ua.includes("Mac") && "ontouchend" in document);
      }

      function redirect(url) {
        window.location.replace(url);
        setTimeout(() => {
          statusEl.textContent = "If nothing happens, choose your store:";
          fallbackEl.hidden = false;
        }, 2000);
      }

      const ua = navigator.userAgent || navigator.vendor || window.opera;

      if (override === "ios") return redirect(IOS_URL);
      if (override === "android") return redirect(ANDROID_URL);

      if (isAndroid(ua)) {
        statusEl.textContent = "Detected Android device…";
        redirect(ANDROID_URL);
      } else if (isIOS(ua)) {
        statusEl.textContent = "Detected iOS device…";
        redirect(IOS_URL);
      } else {
        statusEl.textContent = "Detected Desktop device…";
        redirect(WEB_URL);
      }
    })();
  </script>
</body>
</html>
